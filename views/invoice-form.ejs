<h1>New Invoice</h1>
<div id="invoice-form-container">
    <form action="/invoices/create" method="POST">
        <div>
            <label for="clientName">Client: </label>
            <select id="clientName" name="clientName">
                <% profiles.forEach(profile => { %>
                    <option value="<%= profile._id %>"><%= profile.name %></option>
                <% }) %>
            </select>
        </div>
        
        <label for="invoiceNumber">Invoice Number: </label>
        <input id="invoiceNumber" name="invoiceNumber" type="text" value="<%= invoice.invoiceNumber %>">
        <label for="issueDate">Issue Date: </label>
        <input id="issueDate" name="issueDate" type="date" value="<%= invoice.invoiceDate %>">
        <label for="dueDate">Due Date: </label>
        <input id="dueDate" name="dueDate" type="date" value="<%= invoice.invoiceDueDate %>">

        <input type="hidden" name="productIds[]" value="0">
        <input type="hidden" name="productQuantities[]" value="0">

        <label for="invoiceProduct">Products: </label>
        <div class="input-wrapper" class="line-item-row" id="line-items">
            <select id="invoiceProduct" name="productIds[]">
                <% products.forEach(product => { %>
                    <option value="<%= product._id %>"><%= product.productName %></option>
                <% }) %>
            </select>
            <label for="itemAmount">Quantity: </label>
            <input id="itemAmount" name="productQuantities[]" type="number" value="1">
        </div>

        <button class="btn btn-primary" type="button" id="addLineItem" onclick="addLineItems()">+ Add Another Line Item</button>
        <button class="btn btn-success" type="submit" value="Submit">Save</button>
        <a class="btn btn-danger" href="/invoices">Cancel</a>
    </form>
</div>
<%= errorMessage %>
<script>
    const addLineItems = () => {
        const lineItems = document.querySelector(".input-wrapper");
        const clonedLineItem = lineItems.cloneNode(true);
        document.getElementById("line-items").appendChild(clonedLineItem);
    }
</script>
